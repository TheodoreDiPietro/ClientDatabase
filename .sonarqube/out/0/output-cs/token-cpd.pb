‚
BC:\Users\Th√©odore\source\repos\ConsoleApp4\ConsoleApp4\Address.cs
	namespace 	
ClientDatabase
 
{ 
public 

class 
Address 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[

 	
Required

	 
]

 
[

 
	MaxLength

 
(

 
$num

  
)

  !
]

! "
public

# )
string

* 0
AddressLine1

1 =
{

> ?
get

@ C
;

C D
set

E H
;

H I
}

J K
[ 	
Required	 
] 
[ 
	MaxLength 
( 
$num  
)  !
]! "
public# )
string* 0
AddressLine21 =
{> ?
get@ C
;C D
setE H
;H I
}J K
[ 	
Required	 
] 
[ 
	MaxLength 
( 
$num  
)  !
]! "
public# )
string* 0
City1 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
[ 	
RegularExpression	 
( 
$str ;
); <
]< =
public 
string 
ZipCode 
{ 
get  #
;# $
set% (
;( )
}* +
public 
List 
< 
Customer 
> #
BillingAddressCustomers 5
{6 7
get8 ;
;; <
set= @
;@ A
}B C
public 
List 
< 
Customer 
> $
ShippingAddressCustomers 6
{7 8
get9 <
;< =
set> A
;A B
}C D
} 
} Ã
CC:\Users\Th√©odore\source\repos\ConsoleApp4\ConsoleApp4\Customer.cs
	namespace 	
ClientDatabase
 
{ 
public 

class 
Customer 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[		 	
Required			 
]		 
[		 
	MaxLength		 
(		 
$num		  
)		  !
]		! "
public		# )
string		* 0
	FirstName		1 :
{		; <
get		= @
;		@ A
set		B E
;		E F
}		G H
[ 	
Required	 
] 
[ 
	MaxLength 
( 
$num  
)  !
]! "
public# )
string* 0
LastName1 9
{: ;
get< ?
;? @
setA D
;D E
}F G
public 
int 
ShippingAddress "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
] 
public 
Address !
	SpAddress" +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 
int 
BillingAddress !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
Address !
	BlAddress" +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
} 
} ®!
BC:\Users\Th√©odore\source\repos\ConsoleApp4\ConsoleApp4\Program.cs
	namespace 	
ClientDatabase
 
{ 
internal 
class 
Program 
{ 
private 
static 
void 
Main  
(  !
)! "
{		 	
var

 
repo

 
=

 
new

 

Repository

 %
(

% &
)

& '
;

' (
var 
user1 
= 
new 
User  
{ 
AddressLine11 
= 
$str  -
,- .
AddressLine12 
= 
$str  /
,/ 0
City1 
= 
$str "
," #
ZipCode1 
= 
$str $
,$ %
AddressLine21 
= 
$str  -
,- .
AddressLine22 
= 
$str  /
,/ 0
City2 
= 
$str "
," #
ZipCode2 
= 
$str $
,$ %
	FirstName 
= 
$str "
," #
LastName 
= 
$str  
} 
; 
Console 
. 
	WriteLine 
( 
repo "
." #
DeleteDb# +
(+ ,
), -
? 
$str 5
: 
$str 7
)7 8
;8 9
var"" 
	addresses"" 
="" 
new"" 
List""  $
<""$ %
Address""% ,
>"", -
{## 
repo$$ 
.$$ 
CreateAddress$$ "
($$" #
user1$$# (
.$$( )
AddressLine11$$) 6
,$$6 7
user1$$8 =
.$$= >
AddressLine12$$> K
,$$K L
user1$$M R
.$$R S
City1$$S X
,$$X Y
user1$$Z _
.$$_ `
ZipCode1$$` h
)$$h i
,$$i j
repo%% 
.%% 
CreateAddress%% "
(%%" #
user1%%# (
.%%( )
AddressLine21%%) 6
,%%6 7
user1%%8 =
.%%= >
AddressLine22%%> K
,%%K L
user1%%M R
.%%R S
City2%%S X
,%%X Y
user1%%Z _
.%%_ `
ZipCode2%%` h
)%%h i
}&& 
;&& 
var)) 
rowsModified)) 
=)) 
repo)) #
.))# $
AddCustomer))$ /
())/ 0
user1))0 5
.))5 6
	FirstName))6 ?
,))? @
user1))A F
.))F G
LastName))G O
,))O P
	addresses))Q Z
)))Z [
;))[ \
rowsModified** 
+=** 
repo**  
.**  !
AddCustomer**! ,
(**, -
$str**- 7
,**7 8
user1**9 >
.**> ?
LastName**? G
,**G H
	addresses**I R
)**R S
;**S T
Console,, 
.,, 
	WriteLine,, 
(,, 
$str,, .
,,,. /
rowsModified,,0 <
),,< =
;,,= >
Console.. 
... 
ReadKey.. 
(.. 
).. 
;.. 
}// 	
public11 
struct11 
User11 
{22 	
public33 
string33 
AddressLine1133 '
;33' (
public44 
string44 
AddressLine1244 '
;44' (
public55 
string55 
City155 
;55  
public66 
string66 
ZipCode166 "
;66" #
public77 
string77 
AddressLine2177 '
;77' (
public88 
string88 
AddressLine2288 '
;88' (
public99 
string99 
City299 
;99  
public:: 
string:: 
ZipCode2:: "
;::" #
public;; 
string;; 
	FirstName;; #
;;;# $
public<< 
string<< 
LastName<< "
;<<" #
}== 	
}>> 
}?? â3
EC:\Users\Th√©odore\source\repos\ConsoleApp4\ConsoleApp4\Repository.cs
	namespace 	
ClientDatabase
 
{ 
internal 
class 

Repository 
{		 
public

 
bool

 
DeleteDb

 
(

 
)

 
{ 	
using 
( 
var 
ctx 
= 
new  
ShopContext! ,
(, -
)- .
). /
{ 
return 
ctx 
. 
Database #
.# $
EnsureDeleted$ 1
(1 2
)2 3
&&4 6
ctx7 :
.: ;
Database; C
.C D
EnsureCreatedD Q
(Q R
)R S
;S T
} 
} 	
public 
int %
RemoveAllDataFromAllTable ,
(, -
)- .
{ 	
using 
( 
var 
ctx 
= 
new  
ShopContext! ,
(, -
)- .
). /
{ 
var 
dbSets 
= 
ctx  
.  !
GetType! (
(( )
)) *
.* +
GetProperties+ 8
(8 9
)9 :
.: ;
Where; @
(@ A
pA B
=>C E
pF G
.G H
PropertyTypeH T
.T U
NameU Y
.Y Z

StartsWithZ d
(d e
$stre l
)l m
)m n
;n o
return 
dbSets 
. 
Select $
($ %
x% &
=>' )
x* +
.+ ,
Name, 0
)0 1
.1 2
Select2 8
(8 9"
RemoveAllDataFromTable9 O
)O P
.P Q
SumQ T
(T U
)U V
;V W
} 
} 	
private 
static 
int "
RemoveAllDataFromTable 1
(1 2
string2 8
	tableName9 B
)B C
{ 	
using 
( 
var 

connection !
=" #
new 
SqlConnection !
(! " 
ConfigurationManager" 6
.6 7
ConnectionStrings7 H
[H I
$strI R
]R S
.S T
ConnectionStringT d
)d e
)e f
{   
var!! 
commandText!! 
=!!  !
string!!" (
.!!( )
Format!!) /
(!!/ 0
$"!!0 2
delete from !!2 >
{!!> ?
	tableName!!? H
}!!H I
"!!I J
,!!J K
	tableName!!L U
)!!U V
;!!V W
var## 
command## 
=## 
new## !

SqlCommand##" ,
(##, -
commandText##- 8
,##8 9

connection##: D
)##D E
;##E F

connection$$ 
.$$ 
Open$$ 
($$  
)$$  !
;$$! "
var%% 
accountNumber%% !
=%%" #
command%%$ +
.%%+ ,
ExecuteNonQuery%%, ;
(%%; <
)%%< =
;%%= >

connection&& 
.&& 
Close&&  
(&&  !
)&&! "
;&&" #
return(( 
accountNumber(( $
;(($ %
})) 
}** 	
internal,, 
int,, 
AddCustomer,,  
(,,  !
string,,! '
	firstName,,( 1
,,,1 2
string,,3 9
lastName,,: B
,,,B C
List,,D H
<,,H I
Address,,I P
>,,P Q
	addresses,,R [
),,[ \
{-- 	
using.. 
(.. 
var.. 
ctx.. 
=.. 
new..  
ShopContext..! ,
(.., -
)..- .
)... /
{// 
foreach00 
(00 
var00 
address00 $
in00% '
	addresses00( 1
)001 2
{11 
var22 
address122  
=22! "
ctx22# &
.22& '
	Addresses22' 0
.220 1
SingleOrDefault221 @
(22@ A
x22A B
=>22C E
x22F G
.22G H
Equals22H N
(22N O
address22O V
)22V W
)22W X
;22X Y
if33 
(33 
address133  
!=33! #
null33$ (
)33( )
ctx33* -
.33- .
	Addresses33. 7
.337 8
Attach338 >
(33> ?
address133? G
)33G H
;33H I
}44 
var77 
c77 
=77 
new77 
Customer77 $
{88 
	FirstName99 
=99 
	firstName99  )
,99) *
LastName:: 
=:: 
lastName:: '
,::' (
	BlAddress;; 
=;; 
	addresses;;  )
[;;) *
$num;;* +
];;+ ,
,;;, -
	SpAddress<< 
=<< 
	addresses<<  )
[<<) *
$num<<* +
]<<+ ,
}== 
;== 
ctx?? 
.?? 
	Customers?? 
.?? 
Add?? !
(??! "
c??" #
)??# $
;??$ %
varAA 
countAA 
=AA 
ctxAA 
.AA  
SaveChangesAA  +
(AA+ ,
)AA, -
;AA- .
returnCC 
countCC 
;CC 
}DD 
}EE 	
internalGG 
AddressGG 
CreateAddressGG &
(GG& '
stringGG' -
addressLine1GG. :
,GG: ;
stringGG< B
addressLine2GGC O
,GGO P
stringGGQ W
cityGGX \
,GG\ ]
stringGG^ d
zipCodeGGe l
)GGl m
{HH 	
varII 
aII 
=II 
newII 
AddressII 
{JJ 
AddressLine1KK 
=KK 
addressLine1KK +
,KK+ ,
AddressLine2LL 
=LL 
addressLine2LL +
,LL+ ,
CityMM 
=MM 
cityMM 
,MM 
ZipCodeNN 
=NN 
zipCodeNN !
}OO 
;OO 
returnQQ 
aQQ 
;QQ 
}RR 	
}SS 
}TT Ò
FC:\Users\Th√©odore\source\repos\ConsoleApp4\ConsoleApp4\ShopContext.cs
	namespace 	
ClientDatabase
 
{ 
public 

class 
ShopContext 
: 
	DbContext (
{ 
public 
DbSet 
< 
Address 
> 
	Addresses '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public

 
DbSet

 
<

 
Customer

 
>

 
	Customers

 (
{

) *
get

+ .
;

. /
set

0 3
;

3 4
}

5 6
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
optionsBuilder 
. 
UseSqlServer '
(' ( 
ConfigurationManager( <
.< =
ConnectionStrings= N
[N O
$strO X
]X Y
.Y Z
ConnectionStringZ j
)j k
;k l
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
Address  '
>' (
(( )
)) *
.* +
HasMany+ 2
(2 3
x3 4
=>5 7
x8 9
.9 :$
ShippingAddressCustomers: R
)R S
.S T
WithOneT [
([ \
x\ ]
=>^ `
xa b
.b c
	SpAddressc l
)l m
. 
HasForeignKey 
( 
x  
=>! #
x$ %
.% &
ShippingAddress& 5
)5 6
.6 7
OnDelete7 ?
(? @
DeleteBehavior@ N
.N O
CascadeO V
)V W
;W X
modelBuilder 
. 
Entity 
<  
Address  '
>' (
(( )
)) *
.* +
HasMany+ 2
(2 3
x3 4
=>5 7
x8 9
.9 :#
BillingAddressCustomers: Q
)Q R
.R S
WithOneS Z
(Z [
x[ \
=>] _
x` a
.a b
	BlAddressb k
)k l
. 
HasForeignKey 
( 
x  
=>! #
x$ %
.% &
BillingAddress& 4
)4 5
.5 6
OnDelete6 >
(> ?
DeleteBehavior? M
.M N
RestrictN V
)V W
;W X
} 	
} 
} 